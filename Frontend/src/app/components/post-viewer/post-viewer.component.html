<div *ngIf="data; else invalidPost">
  <div *ngIf="simpleMode; else fullDetails">

    <div class="post-preview card">
      <div class="card-header d-flex pb-0">
        <div>
          <div class="info text-secondary">
            {{ getCategoryName() }} <img [src]="getCharacterIcon()"> &middot; 
            By <a class="showPointer" (click)="viewAuthor()"  matTooltip="View the author's info">{{ getAuthorName() }}</a> &middot; 
            <a class="showPointer" (click)="viewHistory()"  matTooltip="View this post's edit history">{{ data.createdDate | date }}</a>
          </div>
          
          <h4 class="font-weight-bold mb-0">{{data.title}}</h4>
        </div>
      </div>
      
      <div class="card-body">
        <div *ngIf="!editMode" class="row justify-content-center">
          <div class="col">
            <div class="ratingTool d-flex justify-content-center text-secondary" matTooltip="Upvote this post">
              <mat-icon>thumb_up</mat-icon>
              <div>22</div>
            </div>
          </div>

          <div class="col">
            <div class="ratingTool d-flex justify-content-center text-secondary" matTooltip="Go to comments">
              <mat-icon>comment</mat-icon>
              <div>1</div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
  
  <ng-template #fullDetails>
    <div *ngIf="isLoading; else showDetails">
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </div>

    <ng-template #showDetails>
      <div class="post card">
        <div class="card-header d-flex">
          <div class="ratingTool flex-column text-center text-secondary" matTooltip="Upvote this post">
            <mat-icon>thumb_up</mat-icon>
            <div>22</div>
          </div>
          
          <div>
            <div class="info text-secondary">
              {{ getCategoryName() }} <img [src]="getCharacterIcon()"> &middot; 
              By <a class="showPointer" (click)="viewAuthor()"  matTooltip="View the author's info">{{ getAuthorName() }}</a> &middot; 
              <a class="showPointer" (click)="viewHistory()"  matTooltip="View this post's edit history">{{ data.createdDate | date }}</a>
            </div>
            <h4 class="font-weight-bold mb-0">{{data.title}}</h4>
          </div>
        </div>
        
        <div class="card-body">
          <div *ngIf="data.featuredLink">
            <link-embed #linkEmbed></link-embed>
            <hr class="shortDivider">
          </div>

          <div *ngIf="data.content" [innerHtml]="data.content">
          </div>
        </div>

        <div class="card-footer d-flex justify-content-start flex-wrap text-secondary">
          <button mat-button (click)="onRepost()" matTooltip="Make sure your followers see this delightful post">
              <mat-icon>cached</mat-icon>
              Repost
          </button>
          <button mat-button (click)="onEdit()" class="mr-auto" matTooltip="Edit this versatile post">
              <mat-icon>edit</mat-icon>
              Edit
          </button>

          <button mat-button (click)="onAdd()" matTooltip="Add to your resourceful list">
              <mat-icon>playlist_add</mat-icon>
              Add
          </button>
          <button mat-button (click)="onShare()" matTooltip="Share this delightful post">
              <mat-icon>share</mat-icon>
              Share
          </button>

          <button mat-icon-button [matMenuTriggerFor]="menu" matTooltip="View more ambitious options">
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #menu="matMenu">
            <button mat-menu-item (click)="onReport()" matTooltip="Report this unfortunate post">
                <mat-icon>report</mat-icon>
                <span>Report</span>
            </button>
          </mat-menu>
        </div>
      </div>

      <hr>
      <app-comments></app-comments>
    </ng-template>
  </ng-template>
</div>

<ng-template #invalidPost>
  <p>No valid post given to component.</p>
</ng-template>